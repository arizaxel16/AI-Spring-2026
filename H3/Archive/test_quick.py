import numpy as np, time
from sudoku import get_bcn_for_sudoku
from ac import ac3

board_9 = np.array([
    [5,3,0,0,7,0,0,0,0],[6,0,0,1,9,5,0,0,0],[0,9,8,0,0,0,0,6,0],
    [8,0,0,0,6,0,0,0,3],[4,0,0,8,0,3,0,0,1],[7,0,0,0,2,0,0,0,6],
    [0,6,0,0,0,0,2,8,0],[0,0,0,4,1,9,0,0,5],[0,0,0,0,8,0,0,7,9],
])

print("9x9 BCN...")
bcn9 = get_bcn_for_sudoku(board_9)
print(f"  {len(bcn9[0])} vars, {len(bcn9[1])} constraints")
t0 = time.time()
r, f = ac3(bcn9)
print(f"  AC-3: {time.time()-t0:.4f}s, feasible={f}, singles={sum(1 for v in r[0].values() if len(v)==1)}")

board_16 = np.array([
    [0,15,0,0,0,0,0,8,6,0,0,0,0,3,0,12],
    [0,0,0,13,0,10,0,0,0,0,15,0,14,0,0,0],
    [9,0,0,0,0,0,0,12,16,0,0,0,0,0,0,5],
    [0,0,0,6,0,0,3,0,0,14,0,0,8,0,0,0],
    [0,0,0,0,2,0,0,0,0,0,0,10,0,0,0,0],
    [3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,13],
    [0,0,5,0,0,14,0,0,0,0,3,0,0,11,0,0],
    [0,16,0,0,0,0,0,11,2,0,0,0,0,0,5,0],
    [0,5,0,0,0,0,0,3,11,0,0,0,0,0,2,0],
    [0,0,3,0,0,8,0,0,0,0,14,0,0,5,0,0],
    [13,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3],
    [0,0,0,0,10,0,0,0,0,0,0,2,0,0,0,0],
    [0,0,0,8,0,0,6,0,0,10,0,0,11,0,0,0],
    [5,0,0,0,0,0,0,16,12,0,0,0,0,0,0,9],
    [0,0,0,14,0,13,0,0,0,0,8,0,6,0,0,0],
    [12,0,6,0,0,0,0,2,5,0,0,0,0,0,3,0],
])

print("\n16x16 BCN...")
bcn16 = get_bcn_for_sudoku(board_16)
print(f"  {len(bcn16[0])} vars, {len(bcn16[1])} constraints")
t0 = time.time()
r, f = ac3(bcn16)
print(f"  AC-3: {time.time()-t0:.4f}s, feasible={f}, singles={sum(1 for v in r[0].values() if len(v)==1)}")
